# ボラティリティ分解

本コードは、金融・投資修士課程の卒業論文で用いられるアルゴリズムを示している。計算速度の最適化のため、計算負荷の高い部分はCで実装され、Pythonラッパーから呼び出す構成となっている。最終的なコードは、使用しやすい形で一貫したパイプラインとして統合されている

# アルゴリズムの解説
## ステップ第一: 実現分散 (RV)
資産価格の時間的移動がジャンプ・ディフゥージョン過程に従うものとする。資産価格理論においては独立なジャンプはポアソン課程によって記述される。従って、株価も対数過程　$X(t) \coloneqq \log S(t)$　に対して、以下のダイナミクスを定義する[[1]](#1)。

$$
	\text{d} X(t) = \mu\text{d}t + \sigma \text{d}W^{\mathbb{P}}(t) + J\text{d}X_{\mathcal{P}}(t),
$$

上記の数式で、$\mu$ はドリフト項、$\sigma$ は確率的ボラティリティ過程を表し、$W(t)$ は標準ブラウン運動である。又、$X_{\mathcal{P}}(t)$ はポアソン過程を表し、$J$ はジャンプの大きさを与える。資産価格の実現ボラティリティは、日中に観測される対数リターンの二乗和として定義される。過程 $X(t)$ に対する日中リターンを $r_{t+j,\delta} = X_{t+j,\delta} - X_{t+(j-1),\delta}$ と定義し、ここで対数リターン $r_{t+j,\delta}$ は、取引日 $t$ における $j$*番目*の現実価格変化を表すものとする。それに伴い、実現分散 (Realised Variance, $RV$) は、$1/\delta$ 個の日中リターンの総和として定義される[[2]](#2)。

$$
	RV_{t,t+1}(\delta) = \sum\limits_{j=1}^{1/\delta} r_{t+j,\delta}^2
$$

## ステップ第二: Bi-Power Variation (BV)
[[3]](#3)、[[4]](#4)は、$\delta \to 0$（すなわち日中のサンプリング頻度が無限大に近づく場合）において、実現分散が確率収束の意味で quadratic variation に収束することを示している。その結果、$RV$ は以下の性質を持つことが知られている[[2]](#2):

$$
 	RV_{t,t+1}(\delta) \rightarrow \underbrace{\int_{t}^{t+1} \sigma^2(s)\text{d}s}_{C_{t+1}} + \underbrace{\sum\limits_{t < s \le t+1} J^{2}(s)}_{J_{t+1}}
$$

すなわち、実現分散は連続な連続なサンプルパス成分 ($C$) とジャンプ成分 ($J$) の二つから構成される。実現バイパワー変動 (Realised Bi-Power Variation, $BV$) は、これら二つの成分を分離することを可能にする[[2]](#2)、[[5]](#5):

$$
	BV_{t+1}(\delta) = \mu_{1}^{-2} \sum\limits_{j=2}^{1/\delta} |{r_{t+j,\delta}}| |{r_{t+(j-1),\delta}}|,
$$

上記の数式で、$\mu_{1} = \sqrt{2/\pi}$ である。$\delta \to 0$の極限において、$BV$ は連続成分 $C$ に収束することが示されている。$BV$ は隣接する対数リターンの絶対値の積を加算することによって平滑化されており、その結果として、低頻度で発生するジャンプに対してロバストな性質を持つ。
